# Dynamic access.conf file for pam_access generated by salt-minion(1)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
{% set enabled = salt['pillar.get']('pam_access:enabled', False) -%}
{%- if (enabled) %}
  {%- set pam_access = pillar.get('pam_access', {}) %}
  {%- set allowed_users = pam_access.get('allowed_users', {}) %}
  {%- set denied_users = pam_access.get('denied_users', {}) %}

# Allowed Users and From Where
  {%- for user,locations in allowed_users.items() %}
+ : {{ user }} : {{" ".join(locations) }}
  {%- endfor %}

# Denied Users and From Where
  {%- for user,locations in denied_users.items() %}
- : {{ user }} : {{" ".join(locations) }}
  {%- endfor %}

{%- else %}
# Not enabled by salt yet

{%- endif %}

